const ProductArrBoth = [
  {
    nameSP: "LEVENTS® | DORAEMON FAMOUS CAT TEE",
    img: "./img/products/p1-1.png",
    price: 370000,
    nametag: "Áo thun",
    colorr1: "gray",
    colorr2: "red",
    colorr3: "unset",
    img1: "./img/products/p1-1.png",
    img2: "./img/products/p1-2.jpg",
    img3: "./img/products/p1-2.jpg",
  },
  {
    nameSP: "LEVENTS® | DORAEMON COLLAB TEE",
    img: "./img/products/p2-1.png",
    price: 450000,
    nametag: "Áo thun",
    colorr1: " rgb(235, 232, 226)",
    colorr2: "black",
    colorr3: "unset",
    img1: "./img/products/p2-1.png",
    img2: "./img/products/p2-2.png",
    img3: "./img/products/p2-2.png",
  },
  {
    nameSP: "LEVENTS® DINOSAUR TEE",
    img: "./img/products/p3-1.jpg",
    price: 420000,
    nametag: "Áo thun",
    colorr1: " rgb(235, 232, 226)",
    colorr2: "black",
    colorr3: "blue",
    img1: "./img/products/p3-1.jpg",
    img2: "./img/products/p3-2.jpg",
    img3: "./img/products/p3-3.jpg",
  },
  {
    nameSP: "LEVENTS® INSIDE OUT TEE",
    img: "./img/products/p4-1.jpg",
    price: 390000,
    nametag: "Áo thun",
    colorr1: " rgb(235, 232, 226)",
    colorr2: "black",
    colorr3: "unset",
    img1: "./img/products/p4-1.jpg",
    img2: "./img/products/p4-2.jpg",
    img3: "./img/products/p4-2.jpg",
  },
  {
    nameSP: "LEVENTS® LOVEYOU300K SPECIAL TEE",
    img: "./img/products/p5-1.jpg",
    price: 300000,
    nametag: "Áo thun",
    colorr1: " rgb(235, 232, 226)",
    colorr2: "unset",
    colorr3: "unset",
    img1: "./img/products/p5-1.jpg",
    img2: "./img/products/p5-1.jpg",
    img3: "./img/products/p5-1.jpg",
  },
  {
    nameSP: "LEVENTS® FUNNY CROCODILE TEE",
    img: "./img/products/p6-1.jpg",
    price: 390000,
    nametag: "Áo thun",
    colorr1: "blue",
    colorr2: "black",
    colorr3: "unset",
    img1: "./img/products/p6-1.jpg",
    img2: "./img/products/p6.jpg",
    img3: "./img/products/p6-2.jpg",
  },
  {
    nameSP: "LEVENTS® PUNCH VARSITY",
    img: "./img/products/p7-1.jpg",
    price: 890000,
    nametag: "Áo khoác",
    colorr1: "brown",
    colorr2: "black",
    colorr3: "unset",
    img1: "./img/products/p7-1.jpg",
    img2: "./img/products/p7-2.jpg",
    img3: "./img/products/p7-2.jpg",
  },
  {
    nameSP: "LEVENTS® SELFLOVE BOXY TEE",
    img: "./img/products/p8-1.jpg",
    price: 380000,
    nametag: "Áo thun",
    colorr1: " rgb(235, 232, 226)",
    colorr2: "black",
    colorr3: "unset",
    img1: "./img/products/p8-1.jpg",
    img2: "./img/products/p8-2.jpg",
    img3: "./img/products/p8-1.jpg",
  },
  {
    nameSP: "LEVENTS® | DORAEMON MINI CAT Polo",
    img: "./img/products/p9-1.jpg",
    price: 405000,
    nametag: "Polo",
    colorr1: " rgb(235, 232, 226)",
    colorr2: "black",
    colorr3: "unset",
    img1: "./img/products/p9-1.jpg",
    img2: "./img/products/p9-2.jpg",
    img3: "./img/products/p9-2.jpg",
  },
  {
    nameSP: "LEVENTS® MINI POPULAR Polo",
    img: "./img/products/p10-1.jpg",
    price: 370000,
    nametag: "Polo",
    colorr1: " rgb(235, 232, 226)",
    colorr2: "black",
    colorr3: "unset",
    img1: "./img/products/p10-1.jpg",
    img2: "./img/products/p10-2.jpg",
    img3: "./img/products/p10-2.jpg",
  },
  {
    nameSP: "LEVENTS® STRIPE Polo",
    img: "./img/products/p11-1.jpg",
    price: 420000,
    nametag: "Polo",
    colorr1: " rgb(235, 232, 226)",
    colorr2: "black",
    colorr3: "unset",
    img1: "./img/products/p11-1.jpg",
    img2: "./img/products/p11-2.jpg",
    img3: "./img/products/p11-2.jpg",
  },
  {
    nameSP: "LEVENTS® CINEMA SHIRT",
    img: "./img/products/p12-1.jpg",
    price: 420000,
    nametag: "Sơ mi",
    colorr1: "brown",
    colorr2: "black",
    colorr3: "unset",
    img1: "./img/products/p12-1.jpg",
    img2: "./img/products/p12-2.jpg",
    img3: "./img/products/p12-2.jpg",
  },
  {
    nameSP: "LEVENTS® CITIES SHIRT",
    img: "./img/products/p13-1.jpg",
    price: 420000,
    nametag: "Sơ mi",
    colorr1: " rgb(235, 232, 226)",
    colorr2: "black",
    colorr3: "unset",
    img1: "./img/products/p13-1.jpg",
    img2: "./img/products/p13-2.jpg",
    img3: "./img/products/p13-2.jpg",
  },
  {
    nameSP: "LEVENTS® | DORAEMON COLLAB ZIPPER Hoodie",
    img: "./img/products/p14-1.jpg",
    price: 645000,
    nametag: "Hoodie",
    colorr1: " rgb(235, 232, 226)",
    colorr2: "gray",
    colorr3: "unset",
    img1: "./img/products/p14-1.jpg",
    img2: "./img/products/p14-2.jpg",
    img3: "./img/products/p14-2.jpg",
  },
  {
    nameSP: "LEVENTS® POPULAR LOGO 2.0 Hoodie",
    img: "./img/products/p15-1.jpg",
    price: 590000,
    nametag: "Hoodie",
    colorr1: "yellow",
    colorr2: "gray",
    colorr3: "black",
    img1: "./img/products/p15-1.jpg",
    img2: "./img/products/p15-2.jpg",
    img3: "./img/products/p15-3.jpg",
  },
  {
    nameSP: "LEVENTS® MINI LOGO ZIPPER Hoodie",
    img: "./img/products/p16-1.jpg",
    price: 620000,
    nametag: "Hoodie",
    colorr1: " rgb(235, 232, 226)",
    colorr2: "gray",
    colorr3: "unset",
    img1: "./img/products/p16-1.jpg",
    img2: "./img/products/p16-2.jpg",
    img3: "./img/products/p16-2.jpg",
  },
  {
    nameSP: "LEVENTS® | DORAEMON COLLAB Hoodie",
    img: "./img/products/p17-1.jpg",
    price: 620000,
    nametag: "Hoodie",
    colorr1: " rgb(235, 232, 226)",
    colorr2: "black",
    colorr3: "unset",
    img1: "./img/products/p17-1.jpg",
    img2: "./img/products/p17-2.jpg",
    img3: "./img/products/p17-2.jpg",
  },
  {
    nameSP: "LEVENTS® BASIC Sweater",
    img: "./img/products/p18-1.jpg",
    price: 490000,
    nametag: "Sweater",
    colorr1: "gray",
    colorr2: "red",
    colorr3: "unset",
    img1: "./img/products/p18-1.jpg",
    img2: "./img/products/p18-2.jpg",
    img3: "./img/products/p18-2.jpg",
  },
  {
    nameSP: "LEVENTS® FUNNY CROCODILE Sweater",
    img: "./img/products/p19-1.jpg",
    price: 490000,
    nametag: "Sweater",
    colorr1: "brown",
    colorr2: "black",
    colorr3: "unset",
    img1: "./img/products/p19-1.jpg",
    img2: "./img/products/p19-2.jpg",
    img3: "./img/products/p19-2.jpg",
  },
];
const sale = 0.5;

const sosptrongtrang = 12;
let sp = "";
let max_page = 0;

// Hàm tạo sản phẩm trên trang
function makeSP(trang, sosptrongtrang, arr) {
  sp = "";
  for (let i = (trang - 1) * sosptrongtrang;i < (trang - 1) * sosptrongtrang + sosptrongtrang;i++){
    if (i >= arr.length) break;

    const originalPrice = (arr[i].price + arr[i].price * sale).toLocaleString(
      "vi-VN",
      {
        style: "currency",
        currency: "VND",
      }
    );
    const salePrice = arr[i].price.toLocaleString("vi-VN", {
      style: "currency",
      currency: "VND",
    });
    sp += `
      <div class="item_1">
        <div class="img-item"><img class="srcimg" src="${arr[i].img}" alt=""></div>
        <div class="listColor" id="listColor_item1">
          <div onclick="clickC1(this)" class="itemColor1" data-src="${arr[i].img1}" style="background-color: ${arr[i].colorr1};"></div>
          <div onclick="clickC1(this)" class="itemColor2" data-src="${arr[i].img2}" style="background-color: ${arr[i].colorr2};"></div>
          <div onclick="clickC1(this)" class="itemColor3" data-src="${arr[i].img3}" style="background-color: ${arr[i].colorr3};"></div>
        </div>
        <div class="inf-item">
          <h4>${arr[i].nameSP}</h4>
          <p style="font-style: italic;">Giá gốc: <span style="text-decoration: line-through; font-style: italic;">${originalPrice}</span></p>
          <p style="font-style: italic;">Giá khuyến mãi: <span style="font-size: larger; font-style: italic;">${salePrice}</span></p>
        </div>
        <div class="buy"><i class="fa-solid fa-wallet"></i>Mua Ngay</div>
        <a href="#" style="text-decoration: none; color: black;" onclick='loadSingleProduct(${JSON.stringify(arr[i])})' class="buy"><i class="fa-solid fa-circle-info"></i>Chi Tiết</a>
      </div>
    `;
  }
  document.getElementById("all-item").innerHTML = sp;
}

// Hàm phân trang
function makeselectpage(index, arr) {
  const max_length_arrayproduct = arr.length;
  if (max_length_arrayproduct % sosptrongtrang == 0) {
    max_page = parseInt(max_length_arrayproduct / sosptrongtrang);
  } else {
    max_page = parseInt(max_length_arrayproduct / sosptrongtrang) + 1;
  }
  let s = `
    <div id="body-widePagination">
      <a href="#" class="pagination_item" id="before"><span><i class='bx bx-left-arrow-alt'></i></span></a>
      <a href="#" class="pagination_item act" id="span1"><span id="abc">${index}</span></a>
  `;

  if (index + 1 <= max_page) {
    s += `<a href="#" class="pagination_item" id="span2"><span>${index + 1}</span></a>`;
  }
  if (index + 2 <= max_page) {
    s += `<a href="#" class="pagination_item" id="span3"><span>${index + 2}</span></a>`;
  }
  s += `<a href="#" class="pagination_item" id="next"><span><i class='bx bx-right-arrow-alt'></i></span></a></div>`;

  document.querySelector("#body-widePagination").innerHTML = s;

  const page1 = document.getElementById("span1");
  const page2 = document.getElementById("span2");
  const page3 = document.getElementById("span3");
  const next = document.getElementById("next");
  const before = document.getElementById("before");

  if (index > 1) {
    before.style.visibility = "visible";
  } else {
    before.style.visibility = "hidden";
  }
  if (index >= max_page) {
    next.style.visibility = "hidden";
  } else {
    next.style.visibility = "visible";
  }

  page1.addEventListener("click", () => {
    makeSP(index, sosptrongtrang, arr);
    makeselectpage(index, arr);
  });

  if (page2) {
    page2.addEventListener("click", () => {
      let page2content = parseInt(page2.textContent);
      makeSP(page2content, sosptrongtrang, arr);
      makeselectpage(page2content, arr);
    });
  }

  if (page3) {
    page3.addEventListener("click", () => {
      let page3content = parseInt(page3.textContent);
      makeSP(page3content, sosptrongtrang, arr);
      makeselectpage(page3content, arr);
    });
  }

  next.addEventListener("click", () => {
    let nextPage = index + 1;
    if (nextPage <= max_page) {
      makeSP(nextPage, sosptrongtrang, arr);
      makeselectpage(nextPage, arr);
    }
  });

  before.addEventListener("click", () => {
    let previousPage = index - 1;
    if (previousPage > 0) {
      makeSP(previousPage, sosptrongtrang, arr);
      makeselectpage(previousPage, arr);
    }
  });
}

// Hàm chạy khi trang tải
window.onload = function () {
  makeSP(1, sosptrongtrang, ProductArrBoth);
  makeselectpage(1, ProductArrBoth);
};

// sort
function sapxeptang(arr) {
  for (let i = 0; i < arr.length - 1; i++) {
    for (let j = i + 1; j < arr.length; j++) {
      if (parseInt(arr[i].price) > parseInt(arr[j].price)) {
        let tmp = arr[i];
        arr[i] = arr[j];
        arr[j] = tmp;
      }
    }
  }
}
function sapxepgiam(arr) {
  for (let i = 0; i < arr.length - 1; i++) {
    for (let j = i + 1; j < arr.length; j++) {
      if (parseInt(arr[i].price) < parseInt(arr[j].price)) {
        let tmp = arr[i];
        arr[i] = arr[j];
        arr[j] = tmp;
      }
    }
  }
}
const sort = document.querySelector("#sort");
sort.addEventListener("change", () => {
  let choice = parseInt(sort.value);
  switch (choice) {
    case 1:
      sapxeptang(ProductArrBoth);
      break;
    case 2:
      sapxepgiam(ProductArrBoth);
      break;
    case 3:
      location.reload();
      break;
  }
  makeSP(1, sosptrongtrang, ProductArrBoth);
  makeselectpage(1, ProductArrBoth);
});
//radio-search
function mangproduct_radio(radio, arr) {
  let mang = [];
  for (let i = 0; i < arr.length; i++) {
    // Kiểm tra nếu nametag của đối tượng trong mảng trùng với radio đã chọn
    if (arr[i].nametag == radio) {
      mang.push(arr[i]);
    }
  }
  return mang;
}

const radio_btn = document.querySelectorAll(".radio-btn");

radio_btn.forEach((i) => {
  i.addEventListener("change", () => {
    if (i.checked) {
      let span = i.nextElementSibling.textContent.trim(); // doc ptu span
      let filteredProducts = mangproduct_radio(span, ProductArrBoth);
      makeSP(1, sosptrongtrang, filteredProducts);
      makeselectpage(1, filteredProducts);
    }
  });
});

//doi mau sac quan ao
function clickC1(e){
  const newSrc = e.getAttribute("data-src"); //data-src chứa URL của hình ảnh tương ứng với màu đó.
  const imgElement = e.closest(".item_1").querySelector(".srcimg"); // tìm phần tử cha gần nhất có lớp item_1 ếp tục tìm phần tử ảnh bên trong phần tử cha item_1
  imgElement.setAttribute("src", newSrc);
}
